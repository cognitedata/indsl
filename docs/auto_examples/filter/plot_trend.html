<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trending with Empirical Mode Decomposition &mdash; indsl 8.3.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
    <link rel="shortcut icon" href="../../_static/cognite_logo_black.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=53e4bfcb"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            indsl
              <img src="../../_static/cognite_logo_white.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Toolboxes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data_quality.html">Data Quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../detect.html">Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drilling.html">Drilling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../equipment.html">Equipment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filter.html">Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fluid_dynamics.html">Fluid Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../forecast.html">Forecast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../numerical_calculus.html">Numerical Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../oil_and_gas.html">Oil and Gas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resample.html">Resample</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../signals.html">Signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../smooth.html">Smooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sustainability.html">Sustainability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ts_utils.html">Basic time series functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data_quality/index.html">Data quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../detect/index.html">Detection Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../equipment/index.html">Equipment Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Filter Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../forecast/index.html">Forecasting Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numerical_calculus/index.html">Numerical Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oil_and_gas/index.html">Oil and Gas Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resample/index.html">Resampling Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../signals/index.html">Synthetic Signal Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../smooth/index.html">Smoothing Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../statistics/index.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sustainability/index.html">Sustainability Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versioning/index.html">Function versioning</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_tools.html">Developer utility functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html">v8.3.3 (2024-03-20)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v8-3-2-2024-02-23">v8.3.2 (2024-02-23)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v8-3-1-2024-02-02">v8.3.1 (2024-02-02)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v8-3-0-2024-01-15">v8.3.0 (2024-01-15)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v8-2-1">v8.2.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v8-2-0">v8.2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v8-1-0">v8.1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v8-0-1">v8.0.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v8-0-0">v8.0.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v7-0-1">v7.0.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v7-0-0">v7.0.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-6-0a1-pre-release">v6.6.0a1 Pre-release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-6-0a0-2023-07-04">v6.6.0a0 (2023-07-04)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-5-0-2023-03-31">v6.5.0 (2023-03-31)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-4-4-2023-03-23">v6.4.4 (2023-03-23)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-4-3-2023-02-23">v6.4.3 (2023-02-23)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-4-2-2023-01-24">v6.4.2 (2023-01-24)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-4-1-2023-01-24">v6.4.1 (2023-01-24)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-4-0-2022-12-13">v6.4.0 (2022-12-13)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-3-1-2022-11-09">v6.3.1 (2022-11-09)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-3-0-2022-11-08">v6.3.0 (2022-11-08)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-2-0-2022-09-29">v6.2.0 (2022-09-29)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-1-0-2022-08-25">v6.1.0 (2022-08-25)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-0-1-2022-08-17">v6.0.1 (2022-08-17)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v6-0-0-2022-08-17">v6.0.0 (2022-08-17)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-8-2-2022-08-09">v4.8.2 (2022-08-09)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-8-1-2022-08-09">v4.8.1 (2022-08-09)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-8-0-2022-07-26">v4.8.0 (2022-07-26)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-7-0-2022-07-07">v4.7.0 (2022-07-07)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-6-0-2022-06-16">v4.6.0 (2022-06-16)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-5-1-2022-06-09">v4.5.1 (2022-06-09)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-5-0-2022-05-25">v4.5.0 (2022-05-25)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-4-1-2022-05-18">v4.4.1 (2022-05-18)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-4-0-2022-05-11">v4.4.0 (2022-05-11)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-3-1-2022-05-04">v4.3.1 (2022-05-04)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-3-0-2022-04-27">v4.3.0 (2022-04-27)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-2-2-2022-04-21">v4.2.2 (2022-04-21)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-2-1-2022-04-21">v4.2.1 (2022-04-21)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-2-0-2022-04-20">v4.2.0 (2022-04-20)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-1-1-2022-03-30">v4.1.1 (2022-03-30)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-1-0-2022-03-22">v4.1.0 (2022-03-22)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-0-2-2022-03-01">v4.0.2 (2022-03-01)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-0-1-2022-02-28">v4.0.1 (2022-02-28)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v4-0-0-2022-02-24">v4.0.0 (2022-02-24)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v3-1-1-2022-02-02">v3.1.1 (2022-02-02)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v3-1-0-2022-01-21">v3.1.0 (2022-01-21)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v3-0-0-2022-01-14">v3.0.0 (2022-01-14)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v2-1-0-2022-01-05">v2.1.0 (2022-01-05)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v2-0-0-2021-12-20">v2.0.0 (2021-12-20)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v1-0-0-2021-12-06">v1.0.0 (2021-12-06)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v0-2-1-2021-11-11">v0.2.1 (2021-11-11)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v0-2-0-2021-11-04">v0.2.0 (2021-11-04)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v0-1-0-2021-10-29">v0.1.0 (2021-10-29)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v0-0-8-2021-10-18">v0.0.8 (2021-10-18)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v0-0-7-2021-10-18">v0.0.7 (2021-10-18)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v0-0-6-2021-10-18">v0.0.6 (2021-10-18)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#id85">0.0.6 (2021-10-18)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#id87">0.0.5 (2021-10-18)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#v0-0-4-2021-10-13">v0.0.4 (2021-10-13)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#id90">0.0.3 (2021-10-08)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">indsl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Trending with Empirical Mode Decomposition</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/auto_examples/filter/plot_trend.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-filter-plot-trend-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="trending-with-empirical-mode-decomposition">
<span id="sphx-glr-auto-examples-filter-plot-trend-py"></span><h1>Trending with Empirical Mode Decomposition<a class="headerlink" href="#trending-with-empirical-mode-decomposition" title="Link to this heading">ÔÉÅ</a></h1>
<p>Example of trend extraction from non-linear, non-stationary signals using Empirical Mode Decomposition (EMD) and the
Hilbert-Huang Transform. We generate a synthetic signal composed of:</p>
<blockquote>
<div><ul class="simple">
<li><p>Three oscillatory signals of different but significant amplitudes</p></li>
<li><p>Two polynomial functions or trends</p></li>
<li><p>Data drift</p></li>
</ul>
</div></blockquote>
<p>To make the case more realistic, from an industrial perspective, the timestamps are modified to make them nonuniform
and 35% of the data points are randomly removed. Finally, Gaussian noise with a signal-to-noise ratio of 10 db is
added to it.</p>
<p>The figure below shows each of the components of the synthetic signal (except for the Gaussian noise), the resulting
synthetic signal and the trend obtained by means of Empirical Mode Decomposition and the Hilbert-Huang method
implemented. It can be seen that the trend reflects the general signal behaviour. For example, the peak of the signal
near Feb.28 13:00 is reflected in the estimated trend.</p>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_trend_001.png" srcset="../../_images/sphx_glr_plot_trend_001.png" alt="Oscillatory components, Trends & Drift, Signal without noise" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_trend_002.png" srcset="../../_images/sphx_glr_plot_trend_002.png" alt="Trend found using Hilbert-Huang Transform and empirical mode decomposition" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">matplotlib.dates</span> <span class="kn">import</span> <span class="n">DateFormatter</span>

<span class="kn">from</span> <span class="nn">indsl.filter.trend</span> <span class="kn">import</span> <span class="n">trend_extraction_hilbert_transform</span>
<span class="kn">from</span> <span class="nn">indsl.signals</span> <span class="kn">import</span> <span class="n">insert_data_gaps</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">perturb_timestamp</span><span class="p">,</span> <span class="n">sine_wave</span><span class="p">,</span> <span class="n">white_noise</span>


<span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2022-02-28&quot;</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2022-03-02&quot;</span><span class="p">)</span>

<span class="c1"># Wave 1: Small amplitude, long wave period</span>
<span class="n">wave01</span> <span class="o">=</span> <span class="n">sine_wave</span><span class="p">(</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
    <span class="n">sample_freq</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;1m&quot;</span><span class="p">),</span>
    <span class="n">wave_period</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;6h&quot;</span><span class="p">),</span>
    <span class="n">wave_mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">wave_amplitude</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span>
    <span class="n">wave_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">wave01</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">wave01</span><span class="p">)</span>

<span class="c1"># Wave 2: Large amplitude, short wave period</span>
<span class="n">wave02</span> <span class="o">=</span> <span class="n">sine_wave</span><span class="p">(</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
    <span class="n">sample_freq</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;1m&quot;</span><span class="p">),</span>
    <span class="n">wave_period</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;1h&quot;</span><span class="p">),</span>
    <span class="n">wave_mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">wave_amplitude</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">wave_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Wave 3: Large amplitude, short wave period</span>
<span class="n">wave03</span> <span class="o">=</span> <span class="n">sine_wave</span><span class="p">(</span>
    <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
    <span class="n">sample_freq</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;1m&quot;</span><span class="p">),</span>
    <span class="n">wave_period</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;3h&quot;</span><span class="p">),</span>
    <span class="n">wave_mean</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">wave_amplitude</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span>
    <span class="n">wave_phase</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Trends</span>
<span class="n">trend_01</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">line</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span> <span class="n">sample_freq</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;1m&quot;</span><span class="p">),</span> <span class="n">slope</span><span class="o">=</span><span class="mf">0.00008</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span>
<span class="p">)</span>

<span class="n">trend_02</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">line</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span> <span class="n">sample_freq</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;1m&quot;</span><span class="p">),</span> <span class="n">slope</span><span class="o">=-</span><span class="mf">0.00005</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">5</span>
<span class="p">)</span>

<span class="n">drift</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span> <span class="n">sample_freq</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;1m&quot;</span><span class="p">),</span> <span class="n">slope</span><span class="o">=</span><span class="mf">0.00005</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">signal</span> <span class="o">=</span> <span class="n">wave01</span> <span class="o">+</span> <span class="n">wave02</span> <span class="o">+</span> <span class="n">wave03</span> <span class="o">+</span> <span class="n">trend_01</span> <span class="o">+</span> <span class="n">trend_02</span> <span class="o">-</span> <span class="n">drift</span>
<span class="n">signal_w_noise</span> <span class="o">=</span> <span class="n">perturb_timestamp</span><span class="p">(</span><span class="n">white_noise</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">snr_db</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
<span class="n">signal_to_detrend</span> <span class="o">=</span> <span class="n">insert_data_gaps</span><span class="p">(</span><span class="n">signal_w_noise</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Random&quot;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span>

<span class="n">trend</span> <span class="o">=</span> <span class="n">trend_extraction_hilbert_transform</span><span class="p">(</span><span class="n">signal_to_detrend</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave01</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Wave 1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave02</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Wave 2&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave03</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Wave 3&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Oscillatory components&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitude&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trend_01</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Polynomial 1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trend_02</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Polynomial 2&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Trends &amp; Drift&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Magnitude&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;tab:red&quot;</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">drift</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Drift&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Signal without noise&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Signal without noise&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Magnitude&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
<span class="n">fig2</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="c1"># original signal</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal_to_detrend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Signal&quot;</span><span class="p">)</span>

<span class="c1"># Trend extracted from the signal</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Trend of the signal&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Trend found using Hilbert-Huang Transform and empirical mode decomposition&quot;</span><span class="p">)</span>

<span class="c1"># Formatting x axis</span>
<span class="c1"># myFmt = DateFormatter(&quot;%b %d, %H:%M&quot;)</span>
<span class="c1"># axs.xaxis.set_major_formatter(myFmt)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;%b </span><span class="si">%d</span><span class="s2">, %H:%M&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.353 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-filter-plot-trend-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/941f49a4cedc6ef3e156f37f1110f666/plot_trend.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_trend.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/99bc199c1a1c152b1821fa70046f7bcc/plot_trend.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_trend.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Cognite AS &lt;support@cognite.com&gt;.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>